<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="easydel.gonew.mapper.requests">
	<select id="selectMySendRequest" parameterType="string"
		resultType="ViewMySendRequest">
		select		R.request_id as request_id,
					R.cargo_name as cargo_name,
					U.user_id as user_id,
					U.courier_avg_time as courier_avg_time,
					U.courier_avg_kind as courier_avg_kind,
					U.courier_avg_safe as courier_avg_safe,
					U.courier_totalcnt as courier_totalcnt,
					U.courier_successcnt as courier_successcnt,
					R.request_status as request_status,
					C.sender_evalstatus as sender_evalstatus
		from		REQUESTS R
		left join	USERS U
		on			R.courier_id=U.user_id
		left join	COMPLETE_DELIVERYS C
		on			R.request_id=C.request_id
		where		R.request_id not in
						(
							select	request_id
							from	REPORTS
						)
		and			R.sender_id=#{userId}
	</select>
	<select id="selectMyCarryRequest" parameterType="string"
		resultType="ViewMyCarryRequest">
		select		R.request_id as request_id,
					R.cargo_name as cargo_name,
					U.user_id as user_id,
					U.sender_avg_time as sender_avg_time,
					U.sender_avg_kind as sender_avg_kind,
					U.sender_avg_thing as sender_avg_thing,
					U.sender_totalcnt as sender_totalcnt,
					U.sender_successcnt as sender_successcnt,
					R.request_status as request_status,
					R.expire_date as expire_date,
					C.courier_evalstatus as courier_evalstatus
		from		REQUESTS R
		left join	USERS U
		on			R.sender_id=U.user_id
		left join	COMPLETE_DELIVERYS C
		on			R.request_id=C.request_id
		where		R.request_id not in
						(
							select	request_id
							from	REPORTS
						)
		and			R.courier_id=#{userId}
	</select>
	<select id="selectMyReportRequest" parameterType="string"
		resultType="ViewMyReportRequest">
		select		RP.request_id as request_id,
					R.cargo_name as cargo_name,
					RP.reported_user_id as reported_user_id,
					RP.report_user_id as report_user_id,
					RT.report_type_desc as report_type_desc,
					RP.report_date as report_date,
					RP.report_status as report_status
		from		REPORTS RP
		left join	REQUESTS R		
		on			RP.request_id=R.request_id
		left join	REPORT_TYPE RT
		on			RP.report_type=RT.report_type
		where		RP.reported_user_id=#{userId}
		or			RP.report_user_id=#{userId}
	</select>
</mapper>